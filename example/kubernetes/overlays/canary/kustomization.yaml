apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: spring-actor

bases:
- ../../base

# Canary deployment has different name
nameSuffix: -canary

# Label to distinguish canary from stable
commonLabels:
  deployment: canary
  version: canary

# Use different image tag for canary
images:
- name: your-registry/spring-actor-app
  newName: your-registry.io/spring-actor-app
  newTag: canary

# Start with just 1 replica for canary
replicas:
- name: spring-actor
  count: 1

# Canary-specific patches
patchesStrategicMerge:
- deployment-patch.yaml
- service-patch.yaml

configMapGenerator:
- name: spring-actor-config
  behavior: merge
  literals:
  - ENVIRONMENT=canary
  - LOG_LEVEL=DEBUG  # More verbose logging for canary
